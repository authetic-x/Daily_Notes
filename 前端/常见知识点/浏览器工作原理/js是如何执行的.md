## 变量提升

> **所谓的变量提升，是指在 JavaScript 代码执行过程中，JavaScript 引擎把变量的声明部分和函数的声明部分提升到代码开头的“行为”。变量被提升后，会给变量设置默认值，这个默认值就是我们熟悉的 undefined。**

实际上变量和函数声明在代码里的位置是不会改变的，而是在编译阶段被 JS 引擎放入内存中。



## 编译

![js编译](F:%5Cdesktop%5CDaily_Notes%5Cpublic%5Cjs%E7%BC%96%E8%AF%91.png)

一段代码被编译后会生成两部分内容：**执行上下文 (Execution Context)** 和**可执行代码**

> 执行上下文是 Javascript 执行一段代码的运行时环境，比如调用一个函数，就会进入这个函数的执行上下文，确定该函数在执行期间用到的诸如 this、变量、对象以及函数等

其中，执行上下文里变量环境这个对象保存了变量提升的内容。另外，编译阶段如果声明了多个同名函数，那么后面声明的函数会覆盖前面。



## 执行

什么情况会在执行前编译并创建执行上下文呢？

1. 执行全局代码会创建全局执行上下文，且存在于整个页面的生存周期中
2. 调用一个函数，函数体内的代码会被编译且会生成函数的执行上下文，一般函数执行完，其执行上下文就会被销毁
3. 使用 `eval` 函数，里面的代码也会被编译并创建执行上下文

Javascript 引擎会用调用栈来管理执行上下文，比如执行下面一段代码调用栈的情况：

```js
var a = 2
function add(b,c){
  return b+c
}
function addAll(b,c){
var d = 10
result = add(b,c)
return  a+result+d
}
addAll(3,6)
```

![调用栈](F:%5Cdesktop%5CDaily_Notes%5Cpublic%5C%E8%B0%83%E7%94%A8%E6%A0%88.png)



