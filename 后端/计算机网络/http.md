## https

`https = http + SSL/TSL`，https 在传输层和应用层之间多走了一层 `SSL/TSL`，这两个都是加密协议，全称 `Secure Socket Layer 和 Transport Layer Security`

下面详述 `https` 的三大优势：

### 数据加密，防窃听

https 即采用了对称加密又采用了非对称加密，因为非对称加密的加密方式比较耗费性能，所以传输数据采用对称加密，而非对称加密用来加密传输对称加密的密钥

https 一般分为两个过程，**TLS 握手阶段**和**数据通信阶段**，前一个过程是为了协商对称加密的密钥，方式有多种，这里先介绍一种基于非对称加密的方法：

1. 客户端给服务端发送请求
2. 服务端给客户端返回自己的公钥
3. 客户端产生本次会话的对称密钥 SK，用公钥加密后传给服务端
4. 服务端收到后用私钥解密，若成功则返回 ok，否则终止会话
5. 接下，服务端和客户端的通信均使用 SK 加密

https 有两套非对称加密，第一套用于协商加密密钥 SK；第二套用于数字证书签名加密。这两者区别是前者私钥是服务器端产生的，后者是 CA 机构产生的



### 身份验证，放冒充

> 数字证书 = 主体信息 + 数字签名，用于主体身份验证

身份验证是为了确保拿到的公钥是 “正确的公钥”。为了避免有人冒充服务器向客户端发送假的公钥，我们采用了数字证书的机制。首先数字证书由 CA 机构颁发，所以服务端要先申请一个证书；证书的主题信息包括：`版本、序列号、签名算法、颁发者、使用者、域名、公钥信息` 等，注意这里的公钥信息是指服务端用来加密对称加密密钥的那个公钥。然后先用哈希算法对主体部分生成一段字符串，并用 CA 机构的私钥进行加密，就生成了数字签名，主体信息部分加上数字签名就组成了数字证书。服务端将数字证书发送给客户端，客户端通过相似的逆过程取判断信息是否正确。这里用来解密数字签名的公钥是操作系统或浏览器提前内置的，用数字证书里的哈希算法对主体部分生成消息摘要与数字签名解密后的信息做对比，如果一致就表明信息没有被篡改，从而拿到正确的公钥用于完成后面的 TLS 握手部分。



### 完整性校验：HTTPS 的哈希

主要用在两个地方，一是证书的数字签名，二是对称加密的消息摘要，判断通信的数据是否被篡改。



## http2.0

